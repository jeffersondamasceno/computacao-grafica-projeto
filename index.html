<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Computação Gráfica - Protótipo Interativo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-palette"></i> Computação Gráfica
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="bi bi-house"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-info-circle"></i> Sobre</a>
                    </li>
                </ul>
                <div class="navbar-nav">
                    <button class="btn btn-outline-light btn-sm me-2" id="clearCanvas">
                        <i class="bi bi-trash"></i> Limpar
                    </button>
                    <button class="btn btn-outline-light btn-sm me-2" id="toggleGrid">
                        <i class="bi bi-grid"></i> Malha
                    </button>
                    <div class="btn-group me-2" role="group">
                        <button class="btn btn-outline-light btn-sm" id="zoomOut" title="Zoom Out (Ctrl+Scroll)">
                            <i class="bi bi-zoom-out"></i>
                        </button>
                        <span class="btn btn-outline-light btn-sm disabled" id="zoomInfo" style="cursor: default; min-width: 60px;">
                            100%
                        </span>
                        <button class="btn btn-outline-light btn-sm" id="zoomIn" title="Zoom In (Ctrl+Scroll)">
                            <i class="bi bi-zoom-in"></i>
                        </button>
                        <button class="btn btn-outline-light btn-sm" id="zoomReset" title="Reset Zoom">
                            <i class="bi bi-arrow-clockwise"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3 col-lg-2 sidebar">
                <div class="sticky-top pt-3">
                    <h5 class="sidebar-title">Algoritmos</h5>
                    
                    <div class="accordion" id="algorithmsAccordion">
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#bresenhamCollapse">
                                    <i class="bi bi-slash"></i> Bresenham (Linhas)
                                </button>
                            </h2>
                            <div id="bresenhamCollapse" class="accordion-collapse collapse show" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Ponto Inicial (x1, y1)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="x1" value="0" max="20" min="-20" placeholder="x1">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="y1" value="0" max="15" min="-15" placeholder="y1">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">Ponto Final (x2, y2)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="x2" value="10" max="20" min="-20" placeholder="x2">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="y2" value="10" max="15" min="-15" placeholder="y2">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary btn-sm" id="drawLine">
                                            <i class="bi bi-input-cursor-text"></i> Desenhar via Input
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="drawLineInteractive">
                                            <i class="bi bi-pencil"></i> Desenhar Interativo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#circleCollapse">
                                    <i class="bi bi-circle"></i> Círculos
                                </button>
                            </h2>
                            <div id="circleCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Centro (x, y)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="circleX" value="0" placeholder="x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="circleY" value="0" placeholder="y">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">Raio</label>
                                        <input type="number" class="form-control form-control-sm" id="circleRadius" value="10" placeholder="Raio">
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary btn-sm" id="drawCircleFromInput">
                                            <i class="bi bi-input-cursor-text"></i> Desenhar via Input
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="drawCircleInteractive">
                                            <i class="bi bi-pencil"></i> Desenhar Interativo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#ellipseCollapse">
                                    <i class="bi bi-egg"></i> Elipse
                                </button>
                            </h2>
                            <div id="ellipseCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Centro (x, y)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="ellipseX" value="0" placeholder="x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="ellipseY" value="0" placeholder="y">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">Semi-eixos (a, b)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="ellipseA" value="8" placeholder="a">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="ellipseB" value="4" placeholder="b">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary btn-sm" id="drawEllipse">
                                            <i class="bi bi-input-cursor-text"></i> Desenhar via Input
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="drawEllipseInteractive">
                                            <i class="bi bi-pencil"></i> Desenhar Interativo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#bezierCollapse">
                                    <i class="bi bi-bezier2"></i> Curvas de Bézier
                                </button>
                            </h2>
                            <div id="bezierCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Pontos de Controle</label>
                                        <div class="row g-2 mb-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP0x" value="10" placeholder="P0x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP0y" value="10" placeholder="P0y">
                                            </div>
                                        </div>
                                        <div class="row g-2 mb-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP1x" value="-10" placeholder="P1x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP1y" value="0" placeholder="P1y">
                                            </div>
                                        </div>
                                        <div class="row g-2 mb-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP2x" value="10" placeholder="P2x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="bezierP2y" value="-10" placeholder="P2y">
                                            </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary btn-sm w-100" id="drawBezier">
                                        <i class="bi bi-pencil"></i> Desenhar Curva
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#polylineCollapse">
                                    <i class="bi bi-pentagon"></i> Polilinha
                                </button>
                            </h2>
                            <div id="polylineCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Pontos (x,y separados por vírgula)</label>
                                        <textarea class="form-control form-control-sm" id="polylinePoints" rows="3" placeholder="5,5, 10,10, 15,5, 20,10">5,5, 10,10, 15,5, 20,10</textarea>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary btn-sm" id="drawPolyline">
                                            <i class="bi bi-input-cursor-text"></i> Desenhar via Input
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="drawPolylineInteractive">
                                            <i class="bi bi-pencil"></i> Desenhar Interativo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fillCollapse">
                                    <i class="bi bi-fill"></i> Preenchimento
                                </button>
                            </h2>
                            <div id="fillCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-2">
                                        <label class="form-label">Ponto de Semente (x, y)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="seedX" value="0" placeholder="x">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="seedY" value="0" placeholder="y">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label">Algoritmo</label>
                                        <select class="form-select form-select-sm" id="fillAlgorithm">
                                            <option value="recursive">Recursivo (Flood Fill)</option>
                                            <option value="scanline">Varredura (Scanline)</option>
                                        </select>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button class="btn btn-primary btn-sm" id="fillArea">
                                            <i class="bi bi-input-cursor-text"></i> Preencher Área
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="fillAreaInteractive">
                                            <i class="bi bi-pencil"></i> Preencher Interativo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#transformCollapse">
                                    <i class="bi bi-arrows-move"></i> Transformações 2D
                                </button>
                            </h2>
                            <div id="transformCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <div class="mb-3">
                                        <label for="transformType" class="form-label">Tipo de Transformação</label>
                                        <select class="form-select form-select-sm" id="transformType">
                                            <option value="translation" selected>Translação</option>
                                            <option value="rotation">Rotação</option>
                                            <option value="scale">Escala</option>
                                        </select>
                                    </div>
                        
                                    <div id="translationInputs" class="transform-inputs">
                                        <label class="form-label">Vetor de Translação (dx, dy)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="translateX" value="5" title="Deslocamento em X">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="translateY" value="5" title="Deslocamento em Y">
                                            </div>
                                        </div>
                                    </div>
                        
                                    <div id="rotationInputs" class="transform-inputs" style="display: none;">
                                        <label class="form-label">Ângulo (em graus)</label>
                                        <input type="number" class="form-control form-control-sm mb-2" id="rotationAngle" value="45" title="Ângulo de rotação">
                                        
                                        <label class="form-label">Ponto de Pivô (px, py)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="rotationPivotX" value="0" title="Coordenada X do pivô">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="rotationPivotY" value="0" title="Coordenada Y do pivô">
                                            </div>
                                        </div>
                                        <small class="text-muted d-block mt-1">Girar em torno da origem (0,0) ou de um ponto.</small>
                                    </div>
                        
                                    <div id="scaleInputs" class="transform-inputs" style="display: none;">
                                        <label class="form-label">Fatores de Escala (sx, sy)</label>
                                        <div class="row g-2 mb-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="scaleX" value="1.5" step="0.1" title="Fator de escala em X">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="scaleY" value="1.5" step="0.1" title="Fator de escala em Y">
                                            </div>
                                        </div>
                        
                                        <label class="form-label">Ponto Fixo (cx, cy)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="scaleCenterX" value="0" title="Coordenada X do ponto fixo">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="scaleCenterY" value="0" title="Coordenada Y do ponto fixo">
                                            </div>
                                        </div>
                                        <small class="text-muted d-block mt-1">Aumentar/diminuir a partir da origem (0,0) ou de um ponto.</small>
                                    </div>
                        
                                    <div class="d-grid mt-3">
                                        <button class="btn btn-primary btn-sm" id="applyTransform">
                                            <i class="bi bi-check-lg"></i> Aplicar ao Último Desenho
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#projectionCollapse">
                                    <i class="bi bi-box"></i> Projeções 3D
                                </button>
                            </h2>
                            <div id="projectionCollapse" class="accordion-collapse collapse" data-bs-parent="#algorithmsAccordion">
                                <div class="accordion-body">
                                    <p class="text-muted small">Clique no botão abaixo para definir um objeto 3D e projetá-lo no plano 2D.</p>
                                    <button class="btn btn-primary btn-sm w-100" id="openProjectionModal">
                                        <i class="bi bi-box"></i> Abrir Editor de Projeção
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <h6 class="sidebar-title">Configurações</h6>
                        
                        <div class="mb-3">
                            <h6 class="text-primary">Tamanho da Grade</h6>
                            <div class="mb-2">
                                <label class="form-label">Largura (X): <span id="gridWidthValue">40</span></label>
                                <input type="range" class="form-range" id="gridWidth" min="10" max="100" value="40">
                                <small class="text-muted">10 - 100 unidades</small>
                            </div>
                            <div class="mb-2">
                                <label class="form-label">Altura (Y): <span id="gridHeightValue">30</span></label>
                                <input type="range" class="form-range" id="gridHeight" min="10" max="100" value="30">
                                <small class="text-muted">10 - 100 unidades</small>
                            </div>
                            <button class="btn btn-outline-primary btn-sm w-100" id="applyGridSize">
                                <i class="bi bi-check-circle"></i> Aplicar Tamanho
                            </button>
                            <small class="text-muted d-block mt-2">
                                <i class="bi bi-info-circle"></i> 
                                Tamanho do pixel: <span id="currentPixelSize">20</span>px
                            </small>
                        </div>
                        
                        <div class="mb-2">
                            <label class="form-label">Cor</label>
                            <input type="color" class="form-control form-control-color" id="drawColor" value="#ff0000">
                        </div>
                        <div class="mb-2">
                            <label class="form-label">Espessura</label>
                            <input type="range" class="form-range" id="lineWidth" min="1" max="10" value="1">
                            <small class="text-muted">1px - 10px</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-9 col-lg-10">
                <div class="canvas-container">
                    <div class="canvas-scroll-container" id="canvasScrollContainer">
                        <canvas id="drawingCanvas" width="800" height="600"></canvas>
                    </div>
                    <div class="canvas-overlay">
                        <div class="coordinates-display" id="coordinatesDisplay">
                            Passe o mouse sobre o canvas para ver as coordenadas.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="projectionModal" tabindex="-1" aria-labelledby="projectionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="projectionModalLabel"><i class="bi bi-box"></i> Editor de Projeção 3D</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-4">
                            <h6><i class="bi bi-pencil-square"></i> 1. Defina os Vértices 3D</h6>
                            <p class="text-muted small">Insira os pontos (x, y, z) do seu objeto, um por linha. Exemplo: <code>5,5,5</code></p>
                            <textarea id="3dPointsInput" class="form-control" rows="8">
5,5,5
-5,5,5
-5,-5,5
5,-5,5
5,5,-5
-5,5,-5
-5,-5,-5
5,-5,-5
                            </textarea>
                            <h6 class="mt-3"><i class="bi bi-diagram-3"></i> 2. Defina as Arestas</h6>
                            <p class="text-muted small">Conecte os vértices (índice inicial 0). Ex: <code>0,1</code></p>
                            <textarea id="3dEdgesInput" class="form-control" rows="8">
0,1
1,2
2,3
3,0
4,5
5,6
6,7
7,4
0,4
1,5
2,6
3,7
                            </textarea>
                            <button class="btn btn-secondary btn-sm mt-2 w-100" id="update3DObject">
                                <i class="bi bi-arrow-clockwise"></i> Atualizar Objeto 3D
                            </button>
                        </div>
                        <div class="col-lg-8">
                            <h6><i class="bi bi-eye"></i> Visualização 3D</h6>
                            <div id="3d-viewer" class="border rounded bg-light"></div>
                        </div>
                    </div>
                    <hr>
                    <div class="row align-items-end">
                        <div class="col-lg-8">
                            <h6><i class="bi bi-rulers"></i> 3. Selecione a Projeção</h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <label for="projectionType" class="form-label">Tipo de Projeção</label>
                                    <select class="form-select form-select-sm" id="projectionType">
                                        <option value="orthographic" selected>Ortogonal</option>
                                        <option value="perspective">Perspectiva</option>
                                        <option value="cavalier">Cavalier</option>
                                        <option value="cabinet">Cabinet</option>
                                    </select>
                                </div>
                                <div class="col-md-8">
                                    <div id="orthographic-perspective-inputs">
                                        <label class="form-label">Ângulos de Rotação (Graus)</label>
                                        <div class="row g-2">
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="projectionTheta" value="30" title="Rotação em Y (θ)">
                                            </div>
                                            <div class="col-6">
                                                <input type="number" class="form-control form-control-sm" id="projectionPhi" value="45" title="Rotação em X (φ)">
                                            </div>
                                        </div>
                                    </div>
                                    <div id="oblique-inputs" style="display: none;">
                                        <label class="form-label">Ângulo de Projeção (Graus)</label>
                                        <input type="number" class="form-control form-control-sm" id="projectionAlpha" value="45" title="Ângulo α">
                                    </div>
                                    <div id="perspective-d-input" style="display: none;">
                                        <label class="form-label">Distância do Observador (d)</label>
                                        <input type="number" class="form-control form-control-sm" id="projectionD" value="20" title="Distância d">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                             <button class="btn btn-primary w-100" id="applyProjection">
                                <i class="bi bi-check-lg"></i> Aplicar Projeção no Canvas 2D
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.150.1/examples/jsm/"
        }
    }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script src="main.js" type="module"></script>

</body>
</html>